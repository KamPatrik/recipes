<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Zones Calculator - Strava Activity Tracker</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <button id="hamburger-btn" class="hamburger-menu" aria-label="Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-logo">
                <svg width="40" height="40" viewBox="0 0 60 60" fill="none">
                    <path d="M30 5L45 35H15L30 5Z" fill="#FC4C02"/>
                    <path d="M30 35L37.5 50H22.5L30 35Z" fill="#FC4C02" opacity="0.6"/>
                </svg>
                <span>Datable</span>
            </div>
            <div class="nav-user">
                <span id="user-name">Loading...</span>
                <button id="settings-btn" class="btn btn-icon" title="Settings">‚öôÔ∏è</button>
            </div>
        </div>
    </nav>

    <!-- Slide-in Menu -->
    <div id="slide-menu" class="slide-menu">
        <div class="slide-menu-header">
            <h2>Menu</h2>
            <button id="close-menu-btn" class="close-menu-btn" aria-label="Close menu">&times;</button>
        </div>
        <nav class="slide-menu-nav">
            <a href="dashboard.html" class="menu-item">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Dashboard</span>
            </a>
            <a href="heatmap.html" class="menu-item">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                    <line x1="8" y1="2" x2="8" y2="18"></line>
                    <line x1="16" y1="6" x2="16" y2="22"></line>
                </svg>
                <span>Heat Map</span>
            </a>
            <a href="analytics.html" class="menu-item">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="20" x2="18" y2="10"></line>
                    <line x1="12" y1="20" x2="12" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="14"></line>
                </svg>
                <span>Advanced Analytics</span>
            </a>
            <a href="hr-calculator.html" class="menu-item active">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
                <span>HR Zones Calculator</span>
            </a>
            <a href="settings.html" class="menu-item">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M12 1v6m0 6v6m-9-9h6m6 0h6"></path>
                </svg>
                <span>Settings</span>
            </a>
        </nav>
    </div>

    <!-- Menu Overlay -->
    <div id="menu-overlay" class="menu-overlay"></div>

    <div class="analytics-container">
        <div class="analytics-header">
            <h1>üíì Heart Rate Zones Calculator</h1>
            <p class="analytics-subtitle">Calculate your personalized training zones using the Karvonen Method (Heart Rate Reserve)</p>
        </div>

        <!-- Calculator Input -->
        <div class="analytics-chart-card">
            <div class="analytics-chart-header">
                <h2>üìä Your Information</h2>
                <p class="chart-description">Enter your details to calculate personalized heart rate zones</p>
            </div>
            
            <div class="hr-calculator-form">
                <div class="hr-form-row">
                    <div class="hr-form-group">
                        <label for="age-input">
                            <span class="label-icon">üéÇ</span>
                            <span class="label-text">Age (years)</span>
                        </label>
                        <input type="number" id="age-input" class="hr-input" placeholder="25" min="10" max="100" value="30">
                        <p class="input-help">Your current age</p>
                    </div>

                    <div class="hr-form-group">
                        <label for="resting-hr-input">
                            <span class="label-icon">üò¥</span>
                            <span class="label-text">Resting Heart Rate (bpm)</span>
                        </label>
                        <input type="number" id="resting-hr-input" class="hr-input" placeholder="60" min="30" max="100" value="60">
                        <p class="input-help">Measured in the morning before getting up</p>
                    </div>

                    <div class="hr-form-group">
                        <label for="max-hr-input">
                            <span class="label-icon">üî•</span>
                            <span class="label-text">Maximum Heart Rate (bpm)</span>
                        </label>
                        <input type="number" id="max-hr-input" class="hr-input" placeholder="190" min="100" max="220">
                        <p class="input-help">Leave empty to use formula (220 - age)</p>
                    </div>
                </div>

                <button id="calculate-btn" class="btn btn-primary btn-large">
                    üßÆ Calculate My Zones
                </button>
            </div>
        </div>

        <!-- Results -->
        <div id="results-section" class="hidden">
            <!-- Summary Card -->
            <div class="analytics-chart-card hr-summary-card">
                <div class="hr-summary-grid">
                    <div class="hr-summary-item">
                        <div class="hr-summary-icon">üí§</div>
                        <div class="hr-summary-label">Resting HR</div>
                        <div class="hr-summary-value" id="summary-resting">-</div>
                    </div>
                    <div class="hr-summary-item">
                        <div class="hr-summary-icon">‚ö°</div>
                        <div class="hr-summary-label">Max HR</div>
                        <div class="hr-summary-value" id="summary-max">-</div>
                    </div>
                    <div class="hr-summary-item">
                        <div class="hr-summary-icon">üìä</div>
                        <div class="hr-summary-label">HR Reserve</div>
                        <div class="hr-summary-value" id="summary-reserve">-</div>
                    </div>
                </div>
            </div>

            <!-- Zone Cards -->
            <div class="analytics-chart-card">
                <div class="analytics-chart-header">
                    <h2>üéØ Your Training Zones</h2>
                    <p class="chart-description">Based on the Karvonen Method (Heart Rate Reserve)</p>
                </div>

                <div class="hr-zones-grid">
                    <!-- Zone 1 -->
                    <div class="hr-zone-card zone-1">
                        <div class="hr-zone-header">
                            <div class="hr-zone-number">ZONE 1</div>
                            <div class="hr-zone-name">Recovery</div>
                        </div>
                        <div class="hr-zone-range" id="zone-1-range">-</div>
                        <div class="hr-zone-percent">50-60% Intensity</div>
                        <div class="hr-zone-description">Very light activity. Warm-up and cool-down.</div>
                    </div>

                    <!-- Zone 2 -->
                    <div class="hr-zone-card zone-2">
                        <div class="hr-zone-header">
                            <div class="hr-zone-number">ZONE 2</div>
                            <div class="hr-zone-name">Endurance</div>
                        </div>
                        <div class="hr-zone-range" id="zone-2-range">-</div>
                        <div class="hr-zone-percent">60-70% Intensity</div>
                        <div class="hr-zone-description">Light effort. Fat burning and base building.</div>
                    </div>

                    <!-- Zone 3 -->
                    <div class="hr-zone-card zone-3">
                        <div class="hr-zone-header">
                            <div class="hr-zone-number">ZONE 3</div>
                            <div class="hr-zone-name">Tempo</div>
                        </div>
                        <div class="hr-zone-range" id="zone-3-range">-</div>
                        <div class="hr-zone-percent">70-80% Intensity</div>
                        <div class="hr-zone-description">Moderate effort. Aerobic fitness improvement.</div>
                    </div>

                    <!-- Zone 4 -->
                    <div class="hr-zone-card zone-4">
                        <div class="hr-zone-header">
                            <div class="hr-zone-number">ZONE 4</div>
                            <div class="hr-zone-name">Threshold</div>
                        </div>
                        <div class="hr-zone-range" id="zone-4-range">-</div>
                        <div class="hr-zone-percent">80-90% Intensity</div>
                        <div class="hr-zone-description">Hard effort. Lactate threshold training.</div>
                    </div>

                    <!-- Zone 5 -->
                    <div class="hr-zone-card zone-5">
                        <div class="hr-zone-header">
                            <div class="hr-zone-number">ZONE 5</div>
                            <div class="hr-zone-name">Maximum</div>
                        </div>
                        <div class="hr-zone-range" id="zone-5-range">-</div>
                        <div class="hr-zone-percent">90-100% Intensity</div>
                        <div class="hr-zone-description">Maximum effort. Short intervals and sprints.</div>
                    </div>
                </div>
            </div>

            <!-- Formula Explanation -->
            <div class="analytics-chart-card">
                <div class="analytics-chart-header">
                    <h2>üìñ About the Karvonen Method</h2>
                </div>
                <div class="hr-formula-card">
                    <p>The Karvonen Formula calculates target heart rate zones based on your <strong>Heart Rate Reserve (HRR)</strong>, which is the difference between your maximum and resting heart rate.</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">Formula:</div>
                        <div class="formula-text">Target HR = ((Max HR - Resting HR) √ó Intensity%) + Resting HR</div>
                    </div>

                    <div class="formula-example">
                        <strong>Example:</strong> For Zone 2 (60-70% intensity):
                        <ul>
                            <li>If Max HR = 190 bpm and Resting HR = 60 bpm</li>
                            <li>HR Reserve = 190 - 60 = 130 bpm</li>
                            <li>Zone 2 Lower = (130 √ó 0.60) + 60 = 138 bpm</li>
                            <li>Zone 2 Upper = (130 √ó 0.70) + 60 = 151 bpm</li>
                        </ul>
                    </div>

                    <p style="margin-top: 1rem;"><strong>Why is it better?</strong> The Karvonen method is more accurate than simple percentage of max HR because it accounts for your fitness level through your resting heart rate.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- App Scripts -->
    <script src="js/db-cache.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/hr-calculator.js"></script>

    <!-- Hamburger Menu Script -->
    <script>
        function setupHamburgerMenu() {
            const hamburgerBtn = document.getElementById('hamburger-btn');
            const slideMenu = document.getElementById('slide-menu');
            const menuOverlay = document.getElementById('menu-overlay');
            const closeMenuBtn = document.getElementById('close-menu-btn');

            function openMenu() {
                slideMenu.classList.add('active');
                menuOverlay.classList.add('active');
                hamburgerBtn.classList.add('active');
            }

            function closeMenu() {
                slideMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                hamburgerBtn.classList.remove('active');
            }

            hamburgerBtn.addEventListener('click', () => {
                if (slideMenu.classList.contains('active')) {
                    closeMenu();
                } else {
                    openMenu();
                }
            });

            closeMenuBtn.addEventListener('click', closeMenu);
            menuOverlay.addEventListener('click', closeMenu);
        }

        setupHamburgerMenu();
    </script>
</body>
</html>
